2025-11-17 17:02:40,682 - INFO - --- 任务开始: GNN 原始数据预处理 ---
2025-11-17 17:02:40,682 - INFO - --- 步骤 1: 正在加载和清理数据 ---
2025-11-17 17:02:51,446 - WARNING -     跳过文件 combined_03.csv，因为它未在 MAPPING 中定义。
2025-11-17 17:03:57,044 - INFO - --- 任务开始: GNN 原始数据预处理 ---
2025-11-17 17:03:57,044 - INFO - --- 步骤 1: 正在加载和清理数据 ---
2025-11-17 17:04:53,574 - INFO - 成功加载 10 个风机数据。
2025-11-17 17:04:53,575 - INFO - --- 步骤 2: 正在对齐时间戳 (模板: Farm 1) ---
2025-11-17 17:04:53,763 - INFO -     找到公共时间范围: 2022-04-01 00:00:06 到 2023-03-31 23:59:54
2025-11-17 17:04:53,823 - INFO -     创建 '主时间轴' 成功，包含 4654664 个时间点。
2025-11-17 17:04:54,391 - ERROR - !!! 时间对齐失败: index must be monotonic increasing or decreasing
2025-11-17 17:05:54,660 - INFO - --- 任务开始: GNN 原始数据预处理 ---
2025-11-17 17:05:54,661 - INFO - --- 步骤 1: 正在加载和清理数据 ---
2025-11-17 17:09:23,730 - INFO - --- 任务开始: GNN 原始数据预处理 ---
2025-11-17 17:09:23,730 - INFO - --- 步骤 1: 正在加载和清理数据 ---
2025-11-17 17:10:12,839 - INFO - --- 任务开始: GNN 原始数据预处理 ---
2025-11-17 17:10:12,839 - INFO - --- 步骤 1: 正在加载和清理数据 ---
2025-11-17 17:11:10,087 - INFO - 成功加载 10 个风机数据。
2025-11-17 17:11:10,087 - INFO - --- 步骤 2: 正在对齐时间戳
2025-11-17 17:11:10,278 - INFO -     找到公共时间范围: 2022-04-01 00:00:06 到 2023-03-31 23:59:54
2025-11-17 17:11:10,297 - INFO -     创建 '时间轴' 成功，包含 4505142 个时间点。
2025-11-17 17:11:38,089 - INFO -     所有风机已成功对齐到 '主时间轴'。
2025-11-17 17:11:38,090 - INFO - --- 步骤 3: 正在创建特征 (窗口: 10min) ---
2025-11-17 17:12:14,310 - INFO -     特征创建完毕。
2025-11-17 17:12:14,333 - INFO - --- 步骤 4: 正在计算 GNN 邻接矩阵 ---
2025-11-17 17:12:14,334 - INFO -     节点坐标 (x,y) 数组 (顺序: Farm 1 到 10):
 [[38508747.  3875372.]
 [38509538.  3875289.]
 [38513264.  3874825.]
 [38514821.  3874546.]
 [38518152.  3875364.]
 [38519380.  3875153.]
 [38520854.  3875241.]
 [38520843.  3872643.]
 [38519738.  3873102.]
 [38521573.  3871004.]]
2025-11-17 17:12:14,335 - INFO -     GNN 邻接矩阵 (A) (前5x5):
 [[1.    0.843 0.    0.    0.   ]
 [0.843 1.    0.022 0.    0.   ]
 [0.    0.022 1.    0.509 0.   ]
 [0.    0.    0.509 1.    0.042]
 [0.    0.    0.    0.042 1.   ]]
2025-11-17 17:12:14,335 - INFO - --- 步骤 5: 正在堆叠并保存数据 ---
2025-11-17 17:12:17,435 - INFO -     正在将数据堆叠为 3D 数组...
2025-11-17 17:12:23,502 - INFO -     最终的 3D 数据形状: (4505142, 10, 11)
2025-11-17 17:12:23,502 - INFO -     特征顺序: ['WindSpeed', 'Wind_U', 'Wind_V', 'hour_sin', 'hour_cos', 'month_sin', 'month_cos', 'TurbulenceIntensity', 'WS_rolling_mean', 'U_rolling_mean', 'V_rolling_mean']
2025-11-17 17:12:23,502 - INFO -     正在压缩和保存 .npz 文件 (这可能需要几分钟)...
2025-11-17 17:15:39,942 - INFO -     (未归一化)数据已保存到: /home/luoew/project/farm_predict/data/windfarm_gnn_unscaled_data.npz
2025-11-17 17:15:40,656 - INFO - --- 任务成功完成! ---
